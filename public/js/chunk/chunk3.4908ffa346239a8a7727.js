webpackJsonp([3],{"+4aN":function(t,e,n){var o=n("SRWl");"string"==typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);n("rjj0")("eddde2fc",o,!0,{})},"/Ijh":function(t,e,n){(t.exports=n("FZ+f")(!1)).push([t.i,"",""])},"/oa1":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=u(n("dSCJ")),a=u(n("h7KM")),r=u(n("05vI")),s=u(n("mjpr")),i=u(n("8fKe"));function u(t){return t&&t.__esModule?t:{default:t}}e.default={components:{MyLists:o.default,Create:r.default,Update:s.default,Permission:i.default},mixins:[a.default],name:"index",data:function(){var t=this;return{columns:[{title:"角色名称",key:"name"},{title:"用户数量",key:"users_count"},{title:"操作",render:function(e,n){var o=n.row;return e("button-group",null,[e("i-button",{attrs:{size:"small"},on:{click:function(){return t.showComponent("Update",o)}}},["修改"]),e("i-button",{attrs:{size:"small"},on:{click:function(){return t.showComponent("Permission",o)}}},["分配权限"]),e("poptip",{attrs:{confirm:!0,transfer:!0,title:"确定要删除吗？"},on:{"on-ok":function(){return t.destroyItem(o,"role/"+o.id)}}},[e("i-button",{attrs:{size:"small"}},["删除"])])])}}]}},methods:{search:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.$http.get("role",{params:this.request(e)}).then(function(e){t.assignmentData(e.data.data)})}}}},"05vI":function(t,e,n){var o=n("VU/8")(n("sUXe"),n("N+4O"),!1,function(t){n("yzYB")},"data-v-3e914c13",null);t.exports=o.exports},"6NqX":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:{data:{}},data:function(){return{loading:!1}},methods:{change:function(t){!1===t&&this.$emit("on-change")}}}},"6saD":function(t,e,n){var o=n("VGfQ");"string"==typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);n("rjj0")("21599598",o,!0,{})},"8fKe":function(t,e,n){var o=n("VU/8")(n("VH6A"),n("m+3V"),!1,function(t){n("KAy3")},"data-v-60735ca2",null);t.exports=o.exports},BiWG:function(t,e,n){(t.exports=n("FZ+f")(!1)).push([t.i,"",""])},"HtL/":function(t,e,n){var o=n("VU/8")(n("i1uw"),n("uI0F"),!1,function(t){n("6saD")},"data-v-e32415a4",null);t.exports=o.exports},KAy3:function(t,e,n){var o=n("BiWG");"string"==typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);n("rjj0")("26d383c2",o,!0,{})},"N+4O":function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("component-modal",{attrs:{title:"创建角色"}},[n("Form",{ref:"formCreate",attrs:{model:t.formCreate,"label-width":80}},[n("FormItem",{attrs:{label:"角色名称",prop:"name",rules:{required:!0,message:"角色名称不能为空"}}},[n("Input",{attrs:{placeholder:"角色名称"},model:{value:t.formCreate.name,callback:function(e){t.$set(t.formCreate,"name",e)},expression:"formCreate.name"}})],1),t._v(" "),n("FormItem",{attrs:{label:"是否开启",prop:"status"}},[n("RadioGroup",{attrs:{type:"button"},model:{value:t.formCreate.status,callback:function(e){t.$set(t.formCreate,"status",e)},expression:"formCreate.status"}},[n("Radio",{attrs:{label:1,value:1}},[t._v("开启")]),t._v(" "),n("Radio",{attrs:{label:0,value:0}},[t._v("关闭")])],1)],1),t._v(" "),n("FormItem",{attrs:{label:"角色描述",prop:"description"}},[n("Input",{attrs:{type:"textarea",placeholder:"角色描述"},model:{value:t.formCreate.description,callback:function(e){t.$set(t.formCreate,"description",e)},expression:"formCreate.description"}})],1)],1),t._v(" "),n("div",{attrs:{slot:"footer"},slot:"footer"},[n("Button",{attrs:{loading:t.loading},on:{click:function(e){t.createSubmit("formCreate","role")}}},[t._v("创建")])],1)],1)},staticRenderFns:[]}},"Q/YR":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"my-lists",props:{value:{type:Object,default:function(){return{data:[],page:{total:100,current:1,page_size:20}}}},columns:{type:Array,default:function(){return[]}}},data:function(){return{leftCol:[{title:"序号",render:function(t,e){var n=e.index;return t("span",null,[++n])},width:75}],rightCol:[]}},computed:{tableCol:function(){return this.leftCol.concat(this.columns,this.rightCol)}},methods:{change:function(t){this.$emit("change",t)}}}},SRWl:function(t,e,n){(t.exports=n("FZ+f")(!1)).push([t.i,"",""])},UEFe:function(t,e,n){(t.exports=n("FZ+f")(!1)).push([t.i,"",""])},VGfQ:function(t,e,n){(t.exports=n("FZ+f")(!1)).push([t.i,".modal-body[data-v-e32415a4]{max-height:500px;overflow-y:auto}",""])},VH6A:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=i(n("HtL/")),a=i(n("6NqX")),r=i(n("nf43")),s=i(n("9ypu"));function i(t){return t&&t.__esModule?t:{default:t}}e.default={components:{ComponentModal:o.default},mixins:[a.default,r.default,s.default],name:"permission",data:function(){return{role:{perms:[]},oldPermissions:[]}},computed:{treePermissions:function(){var t=this,e=[];return JSON.parse(JSON.stringify(this.oldPermissions)).forEach(function(n){e.push({id:n.id,parent_id:n.parent_id,title:n.title,expand:!0,indeterminate:t.indeterminate(n),checked:t.checked(n)})}),this.toTree(e)},permissions:function(){return this.toChecked(JSON.parse(JSON.stringify(this.treePermissions)))}},mounted:function(){var t=this;this.$nextTick(function(){t.$http.get("permission").then(function(e){t.oldPermissions=e.data.data}).catch(function(e){t.formatErrors(e)}),t.$http.get("role/"+t.data.id+"/permission").then(function(e){t.role=e.data.data}).catch(function(e){t.formatErrors(e)})})},methods:{correlationSubmit:function(){var t=this;this.loading=!0,this.$http.post("role/"+this.data.id+"/permission",{permission:this.permissions}).then(function(e){t.$Message.success("Success!"),t.change(!1)}).catch(function(e){t.formatErrors(e)}).finally(function(){t.loading=!1})},child:function(t){return this.oldPermissions.filter(function(e){return e.parent_id==t})},indeterminate:function(t){return this.child(t.id).length>0&&!(void 0===this.role.perms.find(function(e){return e.id===t.id}))},checked:function(t){return!(this.child(t.id).length>0)&&!(void 0===this.role.perms.find(function(e){return e.id===t.id}))},toChecked:function(t){var e=this,n=[];return t.forEach(function(t){!0!==t.indeterminate&&!0!==t.checked||(n.push(t.id),t.children&&t.children.length>0&&(n=n.concat(e.toChecked(t.children))))}),n}}}},aAQQ:function(t,e,n){var o=n("UEFe");"string"==typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);n("rjj0")("10b01c62",o,!0,{})},"awQ+":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=s(n("HtL/")),a=s(n("xi7R")),r=s(n("6NqX"));function s(t){return t&&t.__esModule?t:{default:t}}e.default={name:"update",components:{ComponentModal:o.default},mixins:[a.default,r.default],data:function(){return{formUpdate:{name:"",status:1,description:""}}},mounted:function(){var t=this;this.$http.get("role/"+this.data.id).then(function(e){t.formUpdate=e.data.data}).catch(function(e){t.formatErrors(e)})}}},dSCJ:function(t,e,n){var o=n("VU/8")(n("Q/YR"),n("n1Kp"),!1,function(t){n("+4aN")},"data-v-087d0e2b",null);t.exports=o.exports},h7KM:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o,a=n("nf43"),r=(o=a)&&o.__esModule?o:{default:o};e.default={mixins:[r.default],data:function(){return{searchForm:{},data:{data:[],page:{total:0,current:1,page_size:20}},component:{current:"",data:{}}}},mounted:function(){this.search()},methods:{search:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]},assignmentData:function(t){this.data.data=t.data,this.data.page.total=t.total,this.data.page.current=t.current_page,this.data.page.page_size=t.per_page},showComponent:function(t,e){this.component.current=t,this.component.data=e},hideComponent:function(){this.component.current="",this.component.data={},this.search()},destroyItem:function(t,e){var n=this;this.$http.delete(e).then(function(t){n.search()}).catch(function(t){n.formatErrors(t)})},request:function(t){var e=JSON.parse(JSON.stringify(this.searchForm));return e.page=t,e}}}},h94f:function(t,e,n){(t.exports=n("FZ+f")(!1)).push([t.i,"",""])},i1uw:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"component-modal",props:{title:{type:String,default:"弹窗"}},computed:{loading:function(){return this.$parent.loading}},methods:{change:function(t){this.$parent.$emit("on-change")}}}},jdFx:function(t,e,n){var o=n("VU/8")(n("/oa1"),n("qD9a"),!1,function(t){n("aAQQ")},"data-v-2604afd4",null);t.exports=o.exports},"m+3V":function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("component-modal",{attrs:{title:"分配权限"}},[n("Tree",{attrs:{data:t.treePermissions,"show-checkbox":""}}),t._v(" "),n("div",{attrs:{slot:"footer"},slot:"footer"},[n("Button",{attrs:{loading:t.loading},on:{click:function(e){t.correlationSubmit()}}},[t._v("创建")])],1)],1)},staticRenderFns:[]}},mjpr:function(t,e,n){var o=n("VU/8")(n("awQ+"),n("oanK"),!1,function(t){n("qDE/")},"data-v-4c79c85d",null);t.exports=o.exports},n1Kp:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t._t("default"),t._v(" "),n("div",{staticClass:"box-flex-list"},[n("Card",{attrs:{bordered:!1}},[n("p",{attrs:{slot:"title"},slot:"title"},[n("span",[t._v("列表")]),t._v(" "),t._t("button")],2),t._v(" "),n("Table",{ref:"table",attrs:{columns:t.tableCol,data:t.value.data,size:"small"}}),t._v(" "),n("Page",{attrs:{total:t.value.page.total,size:"small",current:t.value.page.current,"page-size":t.value.page.page_size,"show-total":""},on:{"on-change":t.change}})],1)],1)],2)},staticRenderFns:[]}},oanK:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("component-modal",{attrs:{title:"修改角色"}},[n("Form",{ref:"formUpdate",attrs:{model:t.formUpdate,"label-width":80}},[n("FormItem",{attrs:{label:"角色名称",prop:"name",rules:{required:!0,message:"角色名称不能为空"}}},[n("Input",{attrs:{placeholder:"角色名称"},model:{value:t.formUpdate.name,callback:function(e){t.$set(t.formUpdate,"name",e)},expression:"formUpdate.name"}})],1),t._v(" "),n("FormItem",{attrs:{label:"是否开启",prop:"status"}},[n("RadioGroup",{attrs:{type:"button"},model:{value:t.formUpdate.status,callback:function(e){t.$set(t.formUpdate,"status",e)},expression:"formUpdate.status"}},[n("Radio",{attrs:{label:1,value:1}},[t._v("开启")]),t._v(" "),n("Radio",{attrs:{label:0,value:0}},[t._v("关闭")])],1)],1),t._v(" "),n("FormItem",{attrs:{label:"角色描述",prop:"description"}},[n("Input",{attrs:{type:"textarea",placeholder:"角色描述"},model:{value:t.formUpdate.description,callback:function(e){t.$set(t.formUpdate,"description",e)},expression:"formUpdate.description"}})],1)],1),t._v(" "),n("div",{attrs:{slot:"footer"},slot:"footer"},[n("Button",{on:{click:function(e){t.updateSubmit("formUpdate","role/"+t.data.id)}}},[t._v("更新")])],1)],1)},staticRenderFns:[]}},qD9a:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("my-lists",{attrs:{columns:t.columns},on:{change:t.search},model:{value:t.data,callback:function(e){t.data=e},expression:"data"}},[n("Button",{attrs:{slot:"button",size:"small",type:"success"},on:{click:function(e){t.showComponent("Create")}},slot:"button"},[t._v("添加")]),t._v(" "),n(t.component.current,{tag:"components",attrs:{data:t.component.data},on:{"on-change":t.hideComponent}})],1)},staticRenderFns:[]}},"qDE/":function(t,e,n){var o=n("h94f");"string"==typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);n("rjj0")("685e005a",o,!0,{})},sUXe:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=s(n("HtL/")),a=s(n("xi7R")),r=s(n("6NqX"));function s(t){return t&&t.__esModule?t:{default:t}}e.default={name:"create",components:{ComponentModal:o.default},mixins:[a.default,r.default],data:function(){return{formCreate:{name:"",status:1,description:""}}}}},uI0F:function(t,e){t.exports={render:function(){var t=this.$createElement,e=this._self._c||t;return e("Modal",{attrs:{title:this.title,value:!0,transfer:!1,loading:this.loading,"mask-closable":!1},on:{"on-visible-change":this.change}},[e("div",{staticClass:"modal-body"},[this._t("default")],2),this._v(" "),e("div",{attrs:{slot:"footer"},slot:"footer"},[this._t("footer")],2)])},staticRenderFns:[]}},xi7R:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o,a=n("nf43"),r=(o=a)&&o.__esModule?o:{default:o};e.default={mixins:[r.default],data:function(){return{loading:!1}},methods:{unObserver:function(t){return JSON.parse(JSON.stringify(t))},updateSubmit:function(t,e){var n=this;this.$refs[t].validate(function(o){o?(n.loading=!0,n.$http.put(e,n.unObserver(n._data[t])).then(function(t){n.$Message.success("Success!"),n.change(!1)}).catch(function(t){n.formatErrors(t)}).finally(function(){n.loading=!1})):n.$Message.error("验证不通过!")})},createSubmit:function(t,e){var n=this;this.$refs[t].validate(function(o){o&&(n.loading=!0,n.$http.post(e,n._data[t]).then(function(t){n.$Message.success("Success!"),n.change(!1)}).catch(function(t){n.formatErrors(t)}).finally(function(){n.loading=!1}))})}}}},yzYB:function(t,e,n){var o=n("/Ijh");"string"==typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);n("rjj0")("155de042",o,!0,{})}});