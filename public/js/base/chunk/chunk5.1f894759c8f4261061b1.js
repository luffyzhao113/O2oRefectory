webpackJsonp([5],{"/cFX":function(t,e){t.exports={render:function(){var t=this.$createElement;return(this._self._c||t)("Table",{attrs:{columns:this.mergeCol,data:this.parent,loading:this.loading}})},staticRenderFns:[]}},"/sfj":function(t,e,n){var a=n("VU/8")(n("hPTO"),n("mbik"),!1,function(t){n("yheb")},"data-v-117bdab6",null);t.exports=a.exports},"3A9z":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:{componentProps:{}},data:function(){return{loading:!1}},methods:{change:function(t){!1===t&&this.$emit("on-change")}}}},"3Vps":function(t,e,n){var a=n("Sh2H");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);n("rjj0")("99928668",a,!0,{})},"9sye":function(t,e,n){var a=n("VU/8")(n("xQ9V"),n("gmQy"),!1,function(t){n("g8V/")},"data-v-8bee18ac",null);t.exports=a.exports},Am3z:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a,r=n("y6l7"),o=(a=r)&&a.__esModule?a:{default:a};e.default={mixins:[o.default],methods:{updateSubmit:function(t,e){var n=this;this.$refs[t].validate(function(a){a?(n.loading=!0,n.$http.put(e,n.unObserver(n._data[t])).then(function(t){n.$Message.success("Success!"),n.change(!1)}).catch(function(t){n.formatErrors(t)}).finally(function(){n.loading=!1})):n.$Message.error("验证不通过!")})},createSubmit:function(t,e){var n=this;this.$refs[t].validate(function(a){a&&(n.loading=!0,n.$http.post(e,n._data[t]).then(function(t){n.$Message.success("Success!"),n.change(!1)}).catch(function(t){n.formatErrors(t)}).finally(function(){n.loading=!1}))})}}}},"Bq+m":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=l(n("3A9z")),r=l(n("/sfj")),o=l(n("Am3z")),i=l(n("P6q2"));function l(t){return t&&t.__esModule?t:{default:t}}e.default={name:"create",components:{GroupCascader:i.default,ComponentModal:r.default},mixins:[a.default,o.default],data:function(){return{formCreate:{parent_id:0,sort:1},parents:[]}},mounted:function(){var t=this;this.loading=!0,this.$http.get("category/create").then(function(e){t.parents=e.data.data}).finally(function(){t.loading=!1})}}},"G+XK":function(t,e,n){var a=n("VU/8")(n("Bq+m"),n("eMFA"),!1,function(t){n("ydHq")},"data-v-47aadcd2",null);t.exports=a.exports},LTAw:function(t,e,n){(t.exports=n("FZ+f")(!1)).push([t.i,".modal-body[data-v-117bdab6]{max-height:500px;overflow-y:auto}",""])},NaY4:function(t,e,n){(t.exports=n("FZ+f")(!1)).push([t.i,"",""])},OqCN:function(t,e,n){var a=n("eaQc");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);n("rjj0")("58741bf1",a,!0,{})},P6q2:function(t,e,n){var a=n("VU/8")(n("RNND"),n("pVnx"),!1,function(t){n("3Vps")},"data-v-85964954",null);t.exports=a.exports},RNND:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"group-cascader",props:{data:{type:Array,default:function(){return[]}},value:{},label:{type:String,default:"title"},fValue:{type:String,default:"id"},placeholder:{type:String,default:""},changeOnSelect:{type:Boolean,default:!0}},computed:{formatData:function(){return this.convert(JSON.parse(JSON.stringify(this.data)))},formatValue:{get:function(){var t=this,e=this.data.find(function(e){return e[t.fValue]===t.value});if(e){var n=this.findP(this.data,e);return n.push(e[this.fValue]),n}return[]},set:function(t){t[t.length-1]?this.$emit("input",t[t.length-1]):this.$emit("input",0)}}},methods:{convert:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=[];return t.forEach(function(r,o){r.parent_id===n&&(delete t[o],a.push({value:r[e.fValue],label:r[e.label],children:e.convert(t,r.id)}))}),a},findP:function(t,e){var n=this,a=[];return t.forEach(function(r){r.id===e.parent_id&&(a.push(r[n.fValue]),a=n.findP(t,r).concat(a))}),a}}}},S3A8:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"tabel-expand-tree",props:{data:Array,columns:Array,loading:{type:Boolean,default:!1}},data:function(){var t=this;return{defaultColumn:[{type:"expand",render:function(e,n){var a=n.row;n.index;return e("i-table",{attrs:{"show-header":!1,data:t.child(a.id),columns:t.mergeCol},directives:[{name:"show",value:t.child(a.id)&&t.child(a.id).length}],class:"table-expand-tree-"+t.level(a).length},[])},width:50}]}},computed:{parent:function(){return this.child(0)},mergeCol:function(){return this.defaultColumn.concat(this.columns)},defaultData:function(){var t=JSON.parse(JSON.stringify(this.data));return t.forEach(function(e,n){t[n]._expanded=!0}),t}},methods:{child:function(t){return JSON.parse(JSON.stringify(this.defaultData.filter(function(e){return e.parent_id==t})))},level:function(t){var e,n=[];return(e=this.defaultData.find(function(e){return e.id==t.parent_id}))&&(n.push(e),n=n.concat(this.level(e))),n}}}},Sh2H:function(t,e,n){(t.exports=n("FZ+f")(!1)).push([t.i,"",""])},VWqC:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=o(n("y6l7")),r=o(n("dgho"));function o(t){return t&&t.__esModule?t:{default:t}}e.default={mixins:[a.default,r.default],data:function(){return{searchForm:{},data:{data:[],page:{total:0,current:1,page_size:20}}}},mounted:function(){var t=this;this.$nextTick(function(){t.search()})},methods:{search:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]},assignmentData:function(t){this.data.data=t.data,this.data.page.total=t.total,this.data.page.current=t.current_page,this.data.page.page_size=t.per_page},destroyItem:function(t,e){var n=this;this.$http.delete(e).then(function(t){n.search()}).catch(function(t){n.formatErrors(t)})},request:function(t){var e=JSON.parse(JSON.stringify(this.searchForm));return e.page=t,e}}}},Ynwc:function(t,e,n){var a=n("VU/8")(n("n/P5"),n("dj2L"),!1,function(t){n("OqCN")},"data-v-b1bc97a6",null);t.exports=a.exports},a47e:function(t,e,n){(t.exports=n("FZ+f")(!1)).push([t.i,"",""])},cWh5:function(t,e,n){(t.exports=n("FZ+f")(!1)).push([t.i,".ivu-table-expanded-cell{padding:0!important;height:auto!important;border-bottom:none!important}.ivu-table-expanded-cell>.ivu-table-wrapper{height:100%!important;margin-bottom:0!important;border:none!important}.ivu-table-expanded-cell .table-expand-tree-0 .table-col-title{padding-left:20px}.ivu-table-expanded-cell .table-expand-tree-1 .table-col-title{padding-left:40px}.ivu-table-expanded-cell .table-expand-tree-2 .table-col-title{padding-left:60px}.ivu-table-expanded-cell .table-expand-tree-3 .table-col-title{padding-left:80px}.ivu-table-expanded-cell .table-expand-tree-4 .table-col-title{padding-left:100px}.ivu-table-expanded-cell .table-expand-tree-5 .table-col-title{padding-left:120px}",""])},dgho:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={data:function(){return{component:{current:"",data:{}}}},methods:{showComponent:function(t,e){this.component.current=t,this.component.data=e},hideComponent:function(){this.component.current="",this.component.data={},this.search()}}}},dj2L:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("component-modal",{attrs:{title:"修改类目",loading:t.loading}},[n("Form",{ref:"formUpdate",attrs:{model:t.formUpdate,"label-width":80}},[n("FormItem",{attrs:{label:"类目名称",prop:"name",rules:{required:!0,message:"类目名称必须填写"}}},[n("Input",{attrs:{placeholder:"类目名称"},model:{value:t.formUpdate.name,callback:function(e){t.$set(t.formUpdate,"name",e)},expression:"formUpdate.name"}})],1),t._v(" "),n("FormItem",{attrs:{label:"所属上级",prop:"parent_id"}},[n("group-cascader",{attrs:{placeholder:"顶级类目",data:t.parents,label:"name"},model:{value:t.formUpdate.parent_id,callback:function(e){t.$set(t.formUpdate,"parent_id",e)},expression:"formUpdate.parent_id"}})],1),t._v(" "),n("FormItem",{attrs:{label:"排序",prop:"sort",rules:{required:!0,type:"number",message:"排序必须为数值类型"}}},[n("Input",{attrs:{placeholder:"排序",number:""},model:{value:t.formUpdate.sort,callback:function(e){t.$set(t.formUpdate,"sort",e)},expression:"formUpdate.sort"}})],1)],1),t._v(" "),n("div",{attrs:{slot:"footer"},slot:"footer"},[n("Button",{on:{click:function(e){t.updateSubmit("formUpdate","category/"+t.componentProps.id)}}},[t._v("更新")])],1)],1)},staticRenderFns:[]}},e4VV:function(t,e,n){var a=n("VU/8")(n("S3A8"),n("/cFX"),!1,function(t){n("rYAc")},null,null);t.exports=a.exports},eMFA:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("component-modal",{attrs:{title:"添加类目",loading:t.loading}},[n("Form",{ref:"formCreate",attrs:{model:t.formCreate,"label-width":80}},[n("FormItem",{attrs:{label:"类目名称",prop:"name",rules:{required:!0,message:"类目名称必须填写"}}},[n("Input",{attrs:{placeholder:"类目名称"},model:{value:t.formCreate.name,callback:function(e){t.$set(t.formCreate,"name",e)},expression:"formCreate.name"}})],1),t._v(" "),n("FormItem",{attrs:{label:"所属上级",prop:"parent_id"}},[n("group-cascader",{attrs:{placeholder:"顶级类目",data:t.parents,label:"name"},model:{value:t.formCreate.parent_id,callback:function(e){t.$set(t.formCreate,"parent_id",e)},expression:"formCreate.parent_id"}})],1),t._v(" "),n("FormItem",{attrs:{label:"排序",prop:"sort",rules:{required:!0,type:"number",message:"排序必须为数值类型"}}},[n("Input",{attrs:{placeholder:"排序",number:""},model:{value:t.formCreate.sort,callback:function(e){t.$set(t.formCreate,"sort",e)},expression:"formCreate.sort"}})],1)],1),t._v(" "),n("div",{attrs:{slot:"footer"},slot:"footer"},[n("Button",{on:{click:function(e){t.createSubmit("formCreate","category")}}},[t._v("创建")])],1)],1)},staticRenderFns:[]}},eaQc:function(t,e,n){(t.exports=n("FZ+f")(!1)).push([t.i,"",""])},"g8V/":function(t,e,n){var a=n("a47e");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);n("rjj0")("38c38255",a,!0,{})},gmQy:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"box-flex-list"},[n("Card",[n("p",{attrs:{slot:"title"},slot:"title"},[n("span",[t._v("列表")]),t._v(" "),n("Button",{attrs:{size:"small",type:"success"},on:{click:function(e){t.showComponent("Create")}}},[t._v("添加")])],1),t._v(" "),n("TabelExpandTree",{staticClass:"permission-role",attrs:{columns:t.columns,data:t.lists,loading:t.loading}})],1)],1),t._v(" "),n(t.component.current,{tag:"components",attrs:{componentProps:t.component.data},on:{"on-change":t.hideComponent}})],1)},staticRenderFns:[]}},hPTO:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"component-modal",props:{title:{type:String,default:"弹窗"},width:{type:Number,default:520},loading:{type:Boolean,default:!1}},methods:{change:function(t){this.$parent.$emit("on-change")}}}},mbik:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("Modal",{attrs:{title:t.title,value:!0,transfer:!1,"mask-closable":!1,width:t.width},on:{"on-visible-change":t.change}},[n("div",{staticClass:"modal-body"},[t._t("default")],2),t._v(" "),n("div",{attrs:{slot:"footer"},slot:"footer"},[t._t("footer")],2),t._v(" "),t.loading?n("Spin",{attrs:{size:"large",fix:""}}):t._e()],1)},staticRenderFns:[]}},"n/P5":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=l(n("/sfj")),r=l(n("3A9z")),o=l(n("Am3z")),i=l(n("P6q2"));function l(t){return t&&t.__esModule?t:{default:t}}e.default={name:"update",components:{ComponentModal:a.default,GroupCascader:i.default},mixins:[r.default,o.default],data:function(){return{formUpdate:{name:"",parent_id:0,sort:1},parents:[]}},mounted:function(){var t=this;this.loading=!0,this.$http.get("category/"+this.componentProps.id+"/edit").then(function(e){t.parents=e.data.data.parents,t.formUpdate=e.data.data.row}).finally(function(){t.loading=!1})},methods:{}}},pVnx:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement;return(t._self._c||e)("Cascader",{attrs:{data:t.formatData,"change-on-select":t.changeOnSelect,trigger:"hover",placeholder:t.placeholder,transfer:""},model:{value:t.formatValue,callback:function(e){t.formatValue=e},expression:"formatValue"}})},staticRenderFns:[]}},rYAc:function(t,e,n){var a=n("cWh5");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);n("rjj0")("b9901bca",a,!0,{})},xQ9V:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=l(n("G+XK")),r=l(n("Ynwc")),o=l(n("e4VV")),i=l(n("VWqC"));function l(t){return t&&t.__esModule?t:{default:t}}e.default={name:"index",mixins:[i.default],components:{TabelExpandTree:o.default,Create:a.default,Update:r.default},data:function(){var t=this;return{columns:[{title:"类目名称",key:"name",render:function(t,e){return t("span",{class:"table-col-title"},[e.row.name])}},{title:"属性",render:function(t,e){var n="";return e.row.attributes.forEach(function(t,e){n+=0===e?t.name:","+t.name}),t("div",null,[n])}},{title:"排序",key:"sort"},{title:"操作",render:function(e,n){var a=n.row;return e("button-group",null,[e("i-button",{attrs:{size:"small"},on:{click:function(){return t.showComponent("Update",a)}}},["修改"]),e("i-button",{attrs:{size:"small"},on:{click:function(){return t.attributes(a)}}},["分类属性"]),e("i-button",{attrs:{disabled:t.child(a.id).length>0,size:"small"},on:{click:function(){return t.destroyItem(a,"category/"+a.id)}}},["删除"])])}}],lists:[],loading:!1}},methods:{search:function(){var t=this;this.loading=!0,this.$http.get("category").then(function(e){t.lists=e.data.data}).finally(function(){t.loading=!1})},child:function(t){return this.lists.filter(function(e){return e.parent_id==t})},attributes:function(t){this.$router.push({name:"category.attribute",query:{category_id:t.id}})}}}},ydHq:function(t,e,n){var a=n("NaY4");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);n("rjj0")("582b6a64",a,!0,{})},yheb:function(t,e,n){var a=n("LTAw");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);n("rjj0")("bf9a99e2",a,!0,{})}});